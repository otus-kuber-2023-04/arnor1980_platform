# Выполнено ДЗ №2 
# Тема: Kubernetes controllers. ReplicaSet, Deployment, DaemonSet

 - [x] Основное ДЗ
 - [x] Задание с *
 - [x] Задание с **

## В процессе сделано:
 - Подготовка
	- Развенту кластер kind по заранее подготовленному манифесту
 - Создание Replicaset
	- Создал манифест replicaset для запуска replicaset из образа созданного в ДЗ 1
	- Запустил replicaset и проверил что он не запускается при попытке создания
 	- Дополнил манифест replicaset секцией selector 
	- Перезапустил replicaset и проверил доступность
	- Увеличил количество реплик в сете до 3х, убедился что создалось дополнительно 2 pod
	- Проверил жизнеспособность replicaset, удалив из него все pod и проверил что они пересоздались вновь.
	- Изменил количесов реплик pod в манифесте, применил и убедился в их создании
 - Обновление replicaset
	- Создал новый образ Docker для pod frontend в replicaset
	- Применил и убедился что без пересоздания контейнеров версия в pod не обновляется
	- Контейнеры не обновились поскольку replicaset не управляет версиями и обновлениями контейнеров, а только отслеживает что количесво запущеных контейнеров соответствует количеству указанныому в параметре replicas, и они соответствуют описанному в селекторе правилу.
- Создание Deployment
	- Создал манифест для deployment сервиса payment и нужные образы контейнеров
	- Применил манифест и убедился что все компоненты создались deployment, replicaset, pods
	- Изменил версию контейнера в манифесте и убедился, после применения контейнеры обновляются по очереди: создание нового -> удаление старого
- Обновление Deployment
	- Проверил Replicaset и убедился в наличии старого с 0 реплик и нового с 3 доступными репликами.
	- Откатил Deployment назад, наблюдал за постепенным масштабированием в обратную сторону
- Задание с *
	- Создал 2 манифеста для обновления и отката Deploymnent манипулируя парамерами maxSurge и maxAvailable
		- Создается новых 3 контейнера, удаляеся старых 3 контейнера: maxSure: 3, maxUnavailable: 0 
		- Удаляется старый, создается новый и т.д.: maxSurge:0, maxUnavailable:1
- Создание Deployment с проверкой живости(Probes)
	- Добавил секцию redinesProbe в манифест frontend deployment
	- Запустил и проверил доступность убелися что pod запустились
	- Изменил версию контейнера и URL проверки живости
	- Применил, убедился что в процессе применения возникла ошибка при создании нового pod и процес обновления остановился
	- Проверил статус обновления
- Задание * DaemonSet
	- Создал манифест для daemonset node-exporter
	- Запустил и проверил на каких узлах запустились pod, убедился что на всех рабочих узлах есть нужный pod
	- Проверил curl доступность метрик узла 
- Задание ** Daemonset
	- Изменил манифест таким образом чтобы daemonset запускал pod и на узлах control-plane в соответствии с документацией.

## Как запустить проект:
	- Из рабочего каталога запустить
		kubectl create -f  nodeexporter-daemonset.yaml
		port-forward node-exporter-<id> 9100:9100 # заменить <id> на идентификатор любого pod node-exporter
		
## Как проверить работоспособность:
	- curl localhost:9100/metrics 

## PR checklist:
    - [x] Выставлен label с темой домашнего задания
    - [x] Высалвен label с необходимстью Review



